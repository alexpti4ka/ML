# ML_SC_Simpsons
Задача**: Многоклассовая классификация в условиях сильного дисбаланса классов, а также неправильно оформленного датасета.

**Описание задачи**: Обучить свёрточную нейронную сеть с выходом на полносвязный слой для классификации симпсонов. Это настолько жизненная ситуация, что от этой задачи потом всю жизнь флэшбэки будут. У вас каждая **вторая** задача будет связана с дисбалансом классов. 

Ссылка: https://www.kaggle.com/datasets/alexattia/the-simpsons-characters-dataset

**Целевые метрики:**

Поклассовые
Accuracy > 0.8
Precision > 0.8
Recall > 0.8

**Стратегия:**

✅ 1. Базовая модель (main_model). Обучается на всех классах.
Использует CrossEntropyLoss с весами по классам (с учётом support).

✅ 2. Список редких классов
Выделяются классы с support <= N (например, 20). Эти классы запоминаются как rare_classes.

✅ 3. Отдельная модель для редких (rare_model)
Обучается только на train_df, содержащем редкие классы.

Использует аугментацию и другие loss-функции (например, FocalLoss).

✅ 4. Класс CombinedModel
Оборачивает main_model и rare_model.

Внутри forward():
* Делает предсказание main_model,
* Если оно попадает в rare_classes, передаёт вход rare_model для уточнения,
* Возвращает единый logits.

✅ 5. Делаем больше эпох

✅ 6. ResNet = 34

✅ 7. Оптимизация обучения - ранняя остановка по F1-score